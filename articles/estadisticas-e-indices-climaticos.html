<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="es">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="agroclimatico">
<title>Estadísticas e índices climáticos • agroclimatico</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estadísticas e índices climáticos">
<meta property="og:description" content="agroclimatico">
<meta property="og:image" content="https://agrometeorologiainta.github.io/agromet/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Ir al contenido</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">agroclimatico</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Cambiar la navegación">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Índice</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-art-culos">Artículos</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-art-culos">
    <a class="dropdown-item" href="../articles/estadisticas-e-indices-climaticos.html">Estadísticas e índices climáticos</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Registro de cambios</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Cambiar la navegación" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Buscar" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/AgRoMeteorologiaINTA/agroclimatico/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estadísticas e índices climáticos</h1>
            
      
      <small class="dont-index">Código: <a href="https://github.com/AgRoMeteorologiaINTA/agroclimatico/blob/HEAD/vignettes/estadisticas-e-indices-climaticos.Rmd" class="external-link"><code>vignettes/estadisticas-e-indices-climaticos.Rmd</code></a></small>
      <div class="d-none name"><code>estadisticas-e-indices-climaticos.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AgRoMeteorologiaINTA/agroclimatico" class="external-link">agroclimatico</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="lectura-de-datos-y-metadatos">Lectura de datos y metadatos<a class="anchor" aria-label="anchor" href="#lectura-de-datos-y-metadatos"></a>
</h2>
<p>La función <code><a href="../reference/leer_nh.html">leer_nh()</a></code> importa datos en el formato .DAT
(columnas de ancho fijo) usado por el INTA para distribuir los datos de
las estaciones meteorológicas de su red. A continuación se muestra un
ejemplo con datos de prueba.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">archivo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"NH0358.DAT"</span>, package <span class="op">=</span> <span class="st">"agroclimatico"</span><span class="op">)</span></span>
<span><span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/leer_nh.html">leer_nh</a></span><span class="op">(</span><span class="va">archivo</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></span>
<span><span class="co">#&gt;   codigo codigo_nh      fecha t_max t_min precip lluvia_datos lluvia llovizna</span></span>
<span><span class="co">#&gt; 1      5      0358 1951-01-01  29.2   8.2    0.0            0     NA       NA</span></span>
<span><span class="co">#&gt; 2      5      0358 1951-01-02  31.3  17.4    0.0            0     NA       NA</span></span>
<span><span class="co">#&gt; 3      5      0358 1951-01-03  30.9  18.3    0.0            0     NA       NA</span></span>
<span><span class="co">#&gt; 4      5      0358 1951-01-04  32.9  20.1    5.2            1     NA       NA</span></span>
<span><span class="co">#&gt; 5      5      0358 1951-01-05  32.6  18.4    0.0            0     NA       NA</span></span>
<span><span class="co">#&gt; 6      5      0358 1951-01-06  30.4  10.3    0.0            0     NA       NA</span></span>
<span><span class="co">#&gt;   granizo nieve t_min_5cm t_min_50cm t_suelo_5cm t_suelo_10cm heliofania_efec</span></span>
<span><span class="co">#&gt; 1      NA    NA        NA         NA          NA           NA              NA</span></span>
<span><span class="co">#&gt; 2      NA    NA        NA         NA          NA           NA              NA</span></span>
<span><span class="co">#&gt; 3      NA    NA        NA         NA          NA           NA              NA</span></span>
<span><span class="co">#&gt; 4      NA    NA        NA         NA          NA           NA              NA</span></span>
<span><span class="co">#&gt; 5      NA    NA        NA         NA          NA           NA              NA</span></span>
<span><span class="co">#&gt; 6      NA    NA        NA         NA          NA           NA              NA</span></span>
<span><span class="co">#&gt;   heliofania_rel p_vapor hr td rocio viento_10m viento_2m rad etp</span></span>
<span><span class="co">#&gt; 1             NA      NA NA NA    NA         NA        NA  NA  NA</span></span>
<span><span class="co">#&gt; 2             NA      NA NA NA    NA         NA        NA  NA  NA</span></span>
<span><span class="co">#&gt; 3             NA      NA NA NA    NA         NA        NA  NA  NA</span></span>
<span><span class="co">#&gt; 4             NA      NA NA NA    NA         NA        NA  NA  NA</span></span>
<span><span class="co">#&gt; 5             NA      NA NA NA    NA         NA        NA  NA  NA</span></span>
<span><span class="co">#&gt; 6             NA      NA NA NA    NA         NA        NA  NA  NA</span></span></code></pre></div>
<p>Los metadatos de estas estaciones se ven usando
<code><a href="../reference/metadatos_nh.html">metadatos_nh()</a></code>, que devuelve un data frame con el código de
cada estación, el nombre y su localización.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/metadatos_nh.html">metadatos_nh</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   codigo_nh     estacion    provincia organismo    lat    lon altura</span></span>
<span><span class="co">#&gt; 1      0446       Anguil     La Pampa      INTA -36.50 -63.98    165</span></span>
<span><span class="co">#&gt; 2      0196         Azul Buenos Aires       SMN -36.75 -59.83    132</span></span>
<span><span class="co">#&gt; 3      0221 Bahía Blanca Buenos Aires       SMN -38.73 -62.17     83</span></span>
<span><span class="co">#&gt; 4      0400     Balcarce Buenos Aires      INTA -37.75 -58.30    130</span></span>
<span><span class="co">#&gt; 5      0323    Bariloche    Río Negro       SMN -41.15 -71.17    840</span></span>
<span><span class="co">#&gt; 6      0216       Barrow Buenos Aires      INTA -38.32 -60.25    120</span></span></code></pre></div>
<p>La función permite filtrar datos según su código, un rango de
longitud, o latitud.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/metadatos_nh.html">metadatos_nh</a></span><span class="op">(</span>lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">40</span>, <span class="op">-</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   codigo_nh      estacion    provincia organismo    lat    lon altura</span></span>
<span><span class="co">#&gt; 1      0446        Anguil     La Pampa      INTA -36.50 -63.98    165</span></span>
<span><span class="co">#&gt; 2      0196          Azul Buenos Aires       SMN -36.75 -59.83    132</span></span>
<span><span class="co">#&gt; 3      0221  Bahía Blanca Buenos Aires       SMN -38.73 -62.17     83</span></span>
<span><span class="co">#&gt; 4      0400      Balcarce Buenos Aires      INTA -37.75 -58.30    130</span></span>
<span><span class="co">#&gt; 5      0216        Barrow Buenos Aires      INTA -38.32 -60.25    120</span></span>
<span><span class="co">#&gt; 6      0008 Benito Juárez Buenos Aires       SMN -37.72 -59.78    207</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/metadatos_nh.html">metadatos_nh</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">75</span>, <span class="op">-</span><span class="fl">71</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   codigo_nh    estacion  provincia organismo    lat    lon altura</span></span>
<span><span class="co">#&gt; 1      0323   Bariloche  Río Negro       SMN -41.15 -71.17    840</span></span>
<span><span class="co">#&gt; 2      0525    Chapelco    Neuquén       SMN -40.08 -71.13    779</span></span>
<span><span class="co">#&gt; 3      0158   El Bolsón  Río Negro       SMN -41.97 -71.52    337</span></span>
<span><span class="co">#&gt; 4      0350   El Bolsón  Río Negro       SMN -41.93 -71.55    310</span></span>
<span><span class="co">#&gt; 5      0571 El Calafate Santa Cruz       SMN -50.27 -72.05    204</span></span>
<span><span class="co">#&gt; 6      0303      Esquel     Chubut       SMN -42.90 -71.35    787</span></span></code></pre></div>
<p>El data frame devuelto puede plotearse rápidamente para ver la
ubicación de las estaciones.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/metadatos_nh.html">metadatos_nh</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">75</span>, <span class="op">-</span><span class="fl">71</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="estadisticas-e-indices-climaticos_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="análisis-de-la-precipitación">Análisis de la precipitación<a class="anchor" aria-label="anchor" href="#an%C3%A1lisis-de-la-precipitaci%C3%B3n"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datos_mensuales</span> <span class="op">&lt;-</span> <span class="va">NH0358</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span>fecha <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html" class="external-link">round_date</a></span><span class="op">(</span><span class="va">fecha</span>, <span class="st">"month"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span>precip <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">precip</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            etp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">etp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">datos_mensuales</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   fecha      precip   etp</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1951-01-01   1.48   <span style="color: #BB0000;">NaN</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1951-02-01   4.39   <span style="color: #BB0000;">NaN</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1951-03-01   3.53   <span style="color: #BB0000;">NaN</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1951-04-01   2.00   <span style="color: #BB0000;">NaN</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1951-05-01   7.47   <span style="color: #BB0000;">NaN</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1951-06-01   0.44   <span style="color: #BB0000;">NaN</span></span></span></code></pre></div>
<div class="section level3">
<h3 id="anomalía-porcentual">Anomalía porcentual<a class="anchor" aria-label="anchor" href="#anomal%C3%ADa-porcentual"></a>
</h3>
<p>Una primera aproximacion es calcular cuánto se desvía la
precipitación cada mes de su valor típico en procentaje.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datos_mensuales</span> <span class="op">&lt;-</span> <span class="va">datos_mensuales</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span>mes <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">fecha</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>anomalia <span class="op">=</span> <span class="fu"><a href="../reference/decil.html">anomalia_porcentual</a></span><span class="op">(</span><span class="va">precip</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">datos_mensuales</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   mes [6]</span></span></span>
<span><span class="co">#&gt;   fecha      precip   etp   mes anomalia</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1951-01-01   1.48   <span style="color: #BB0000;">NaN</span>     1  -<span style="color: #BB0000;">0.522</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1951-02-01   4.39   <span style="color: #BB0000;">NaN</span>     2   0.105 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1951-03-01   3.53   <span style="color: #BB0000;">NaN</span>     3  -<span style="color: #BB0000;">0.016</span><span style="color: #BB0000; text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1951-04-01   2.00   <span style="color: #BB0000;">NaN</span>     4  -<span style="color: #BB0000;">0.449</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1951-05-01   7.47   <span style="color: #BB0000;">NaN</span>     5   1.91  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1951-06-01   0.44   <span style="color: #BB0000;">NaN</span>     6  -<span style="color: #BB0000;">0.782</span></span></span></code></pre></div>
<p>Valores cercanos a cero implican que la precipitación de ese mes fue
similar a su valor promedio. 1 indica que llovió el doble de lo normal,
mientras que -0.5 significa que en ese mes llovió la mitad de lo que
suele llover.</p>
<p>Si la idea es usar esta medición para monitoreo, es importante fijar
el período de referencia sobre el cual se calcula la precipitación
media. De otra forma, a medida que se recolectan más datos, los
promedios van a variar y con ellos los valores calculados. Entonces,
para asegurarse de que los datos futuros no modifiquen los percentiles
pasados, se puede especificar el período de referencia con el argumento
<code>referencia</code>. Por ejemplo, este código devuelve el desvío de
cada mes con respecto a la media anterior a 1980.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datos_mensuales</span> <span class="op">&lt;-</span> <span class="va">datos_mensuales</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span>mes <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">fecha</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>anomalia <span class="op">=</span> <span class="fu"><a href="../reference/decil.html">anomalia_porcentual</a></span><span class="op">(</span><span class="va">precip</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span>, referencia <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">fecha</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1980</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><code>referencia</code> también puede ser un vector numérico de
precipitación. Esto es útil si se calcula el valor de referencia a parte
y luego sólo se leen los nuevos datos.</p>
<p>Otras funciones de agroclimatico tienen este argumento, así que para
mantener este período fijo, se puede crear una nueva columna.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datos_mensuales</span> <span class="op">&lt;-</span> <span class="va">datos_mensuales</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>referencia <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">fecha</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1980</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">datos_mensuales</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;   fecha      precip   etp   mes anomalia referencia</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1951-01-01   1.48   <span style="color: #BB0000;">NaN</span>     1  -<span style="color: #BB0000;">0.509</span>  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1951-02-01   4.39   <span style="color: #BB0000;">NaN</span>     2   0.112  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1951-03-01   3.53   <span style="color: #BB0000;">NaN</span>     3   0.068<span style="text-decoration: underline;">7</span> TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1951-04-01   2.00   <span style="color: #BB0000;">NaN</span>     4  -<span style="color: #BB0000;">0.456</span>  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1951-05-01   7.47   <span style="color: #BB0000;">NaN</span>     5   2.52   TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1951-06-01   0.44   <span style="color: #BB0000;">NaN</span>     6  -<span style="color: #BB0000;">0.798</span>  TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="deciles">Deciles<a class="anchor" aria-label="anchor" href="#deciles"></a>
</h3>
<p>Otor indicador que puede analizarse es el decil al que pertenece la
precipitación de cada mes.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datos_mensuales</span> <span class="op">&lt;-</span> <span class="va">datos_mensuales</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span>mes <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">fecha</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>decil <span class="op">=</span> <span class="fu"><a href="../reference/decil.html">decil</a></span><span class="op">(</span><span class="va">precip</span>, referencia <span class="op">=</span> <span class="va">referencia</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">datos_mensuales</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">#&gt;   fecha      precip   etp   mes anomalia referencia decil</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1951-01-01   1.48   <span style="color: #BB0000;">NaN</span>     1  -<span style="color: #BB0000;">0.509</span>  TRUE        2.41</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1951-02-01   4.39   <span style="color: #BB0000;">NaN</span>     2   0.112  TRUE        7.24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1951-03-01   3.53   <span style="color: #BB0000;">NaN</span>     3   0.068<span style="text-decoration: underline;">7</span> TRUE        6.90</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1951-04-01   2.00   <span style="color: #BB0000;">NaN</span>     4  -<span style="color: #BB0000;">0.456</span>  TRUE        2.07</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1951-05-01   7.47   <span style="color: #BB0000;">NaN</span>     5   2.52   TRUE        9.66</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1951-06-01   0.44   <span style="color: #BB0000;">NaN</span>     6  -<span style="color: #BB0000;">0.798</span>  TRUE        1.72</span></span></code></pre></div>
<p>En este caso, si un mes cae en el decil 5, significa que la mitad de
los meses (en el período de referencia) tiene menor precipitación.</p>
</div>
<div class="section level3">
<h3 id="índice-de-intensidad-de-sequía-de-palmer">Índice de intensidad de sequía de Palmer<a class="anchor" aria-label="anchor" href="#%C3%ADndice-de-intensidad-de-sequ%C3%ADa-de-palmer"></a>
</h3>
<p>Un indicador de sequía muy utilizado es el PDSI (Palmer Drought
Severity Index) que además de la precipitación, tiene en cuenta la
evapotranspiración potencial (etp) y la capacidad de carga (cc) del
suelo. agroclimatico provee una función <code><a href="../reference/pdsi.html">pdsi()</a></code> que computa
el PSDI usando los coeficientes originales de Palmer y una función
<code><a href="../reference/pdsi.html">pdsi_ac()</a></code> que usa la version autocalibrada.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datos_mensuales</span> <span class="op">&lt;-</span> <span class="va">datos_mensuales</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pdsi <span class="op">=</span> <span class="fu"><a href="../reference/pdsi.html">pdsi_ac</a></span><span class="op">(</span><span class="va">precip</span>, <span class="va">etp</span>, cc <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">datos_mensuales</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">#&gt;   fecha      precip   etp   mes anomalia referencia decil  pdsi</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1951-01-01   1.48   <span style="color: #BB0000;">NaN</span>     1  -<span style="color: #BB0000;">0.509</span>  TRUE        2.41    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1951-02-01   4.39   <span style="color: #BB0000;">NaN</span>     2   0.112  TRUE        7.24    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1951-03-01   3.53   <span style="color: #BB0000;">NaN</span>     3   0.068<span style="text-decoration: underline;">7</span> TRUE        6.90    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1951-04-01   2.00   <span style="color: #BB0000;">NaN</span>     4  -<span style="color: #BB0000;">0.456</span>  TRUE        2.07    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1951-05-01   7.47   <span style="color: #BB0000;">NaN</span>     5   2.52   TRUE        9.66    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1951-06-01   0.44   <span style="color: #BB0000;">NaN</span>     6  -<span style="color: #BB0000;">0.798</span>  TRUE        1.72    <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">datos_mensuales</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">fecha</span>, <span class="va">pdsi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="estadisticas-e-indices-climaticos_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="índice-estandarizado-de-precipitación">Índice Estandarizado de Precipitación<a class="anchor" aria-label="anchor" href="#%C3%ADndice-estandarizado-de-precipitaci%C3%B3n"></a>
</h2>
<p>A diferencia de los otros índices en el Índice Estandarizado de
Precipitación, a cada observación le puede corresponder más de un valor
(uno por cada escala) y además devuelve una serie completa (es decir,
sin datos faltanes implícitos). Por lo tanto, en vez de usarla con
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code>, se usa con <code><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spi</span> <span class="op">&lt;-</span> <span class="va">datos_mensuales</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span><span class="fu"><a href="../reference/spi_indice.html">spi_indice</a></span><span class="op">(</span><span class="va">fecha</span>, <span class="va">precip</span>, escalas <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, referencia <span class="op">=</span> <span class="va">referencia</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">spi</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   fecha      escala    spi</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1951-01-01      1 -<span style="color: #BB0000;">0.919</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1951-02-01      1  0.398</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1951-03-01      1  0.340</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1951-04-01      1 -<span style="color: #BB0000;">0.585</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1951-05-01      1  1.98 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1951-06-01      1 -<span style="color: #BB0000;">1.07</span></span></span></code></pre></div>
<p>Para seguir la serie temporal en una escala en particular, primero
hay que filtrarla (o calcular el spi sólo para esa escala)</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">spi</span>, <span class="va">escala</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">fecha</span>, <span class="va">spi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="estadisticas-e-indices-climaticos_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<p>Para visualizar todas las escalas computadas, se puede usar
<code><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">geom_contour_filled()</a></code></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">spi</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">fecha</span>, <span class="va">escala</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">geom_contour_filled</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>z <span class="op">=</span> <span class="va">spi</span>, fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">level_mid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="estadisticas-e-indices-climaticos_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="análisis-de-extremos">Análisis de extremos<a class="anchor" aria-label="anchor" href="#an%C3%A1lisis-de-extremos"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">extremos</span> <span class="op">&lt;-</span> <span class="va">NH0358</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span>anio <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">fecha</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span><span class="fu"><a href="../reference/umbrales.html">umbrales</a></span><span class="op">(</span>helada <span class="op">=</span> <span class="va">t_min</span> <span class="op">&lt;=</span> <span class="fl">0</span>,</span>
<span>                     mucho_calor <span class="op">=</span> <span class="va">t_max</span> <span class="op">&gt;=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">extremos</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;    anio extremo         N   prop      na</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">1</span>951 helada         14 0.038<span style="text-decoration: underline;">4</span> 0      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">1</span>951 mucho_calor   144 0.395  0      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>952 helada         22 0.060<span style="text-decoration: underline;">1</span> 0      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">1</span>952 mucho_calor   142 0.389  0.002<span style="text-decoration: underline;">73</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">1</span>953 helada         18 0.049<span style="text-decoration: underline;">3</span> 0      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">1</span>953 mucho_calor   119 0.326  0</span></span></code></pre></div>
<p>El resultado es un data frame con columnas <code>extremo</code> (el
nombre del extremo), <code>N</code> (número de observaciones para las
cuales se dio el extremo), <code>prop</code> (proporción de
observaciones) y <code>na</code> (proporción de valores faltantes),</p>
<p>Una posible visualización de la candidad de días con heladas y calor
sofocante podría ser esta:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">extremos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">anio</span>, <span class="va">prop</span><span class="op">*</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"glm"</span>, method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"quasipoisson"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">extremo</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="estadisticas-e-indices-climaticos_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
<p>Dado que esta función cuenta observaciones, es importante que las
series estén completas. Es decir, sin datos faltanes implícitos. Para
completar la serie, se puede usar la función
<code><a href="../reference/completar_serie.html">completar_serie()</a></code>. Ësta función toma un vector de fechas y
la resolución esperada de los datos y agrega las filas faltantes,
poniendo <code>NA</code> en las columnas. Para tablas con datos para
múltiples estaciones o localidades, conviene primero agrupar.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">completa</span> <span class="op">&lt;-</span> <span class="va">NH0358</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">codigo_nh</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/completar_serie.html">completar_serie</a></span><span class="op">(</span><span class="va">fecha</span>, <span class="st">"1 dia"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dia-promedio-de-inicio-y-fin">Dia promedio de inicio y fin<a class="anchor" aria-label="anchor" href="#dia-promedio-de-inicio-y-fin"></a>
</h2>
<p>Para las heladas, es importante saber el día promedio en el que se da
la primera y la última helada, para eso se puede usar la función
<code><a href="../reference/dias_promedio.html">dias_promedio()</a></code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NH0358</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">t_min</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>          <span class="co"># filtrar sólo los días donde hay heladas.</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span><span class="fu"><a href="../reference/dias_promedio.html">dias_promedio</a></span><span class="op">(</span><span class="va">fecha</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     variable dia mes dia_juliano</span></span>
<span><span class="co">#&gt; 1 primer_dia  28   5         148</span></span>
<span><span class="co">#&gt; 2 ultimo_dia  31   8         243</span></span></code></pre></div>
<p>La primera helada se da, en promedio, el 25 de junio y la úĺtima el
30 de agosto.</p>
<div class="section level3">
<h3 id="persistencia">Persistencia<a class="anchor" aria-label="anchor" href="#persistencia"></a>
</h3>
<p>Un dato importante para cualquier extremo es la longitud de días
consecutivos con el extremo. La función <code>olas</code> (olas de
calor, olas de frío) divide una serie de fechas en eventos de
observaciones consecutivas donde se se da una condición lógica.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">olas_de_temperatura</span> <span class="op">&lt;-</span> <span class="va">NH0358</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reframe.html" class="external-link">reframe</a></span><span class="op">(</span><span class="fu"><a href="../reference/olas.html">olas</a></span><span class="op">(</span><span class="va">fecha</span>, </span>
<span>                 mucho_calor <span class="op">=</span> <span class="va">t_max</span> <span class="op">&gt;=</span> <span class="fl">25</span>, </span>
<span>                 helada <span class="op">=</span> <span class="va">t_min</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">olas_de_temperatura</span><span class="op">)</span></span>
<span><span class="co">#&gt;           ola     inicio        fin longitud</span></span>
<span><span class="co">#&gt; 1 mucho_calor 1951-01-01 1951-01-21  21 days</span></span>
<span><span class="co">#&gt; 2 mucho_calor 1951-01-25 1951-01-31   7 days</span></span>
<span><span class="co">#&gt; 3 mucho_calor 1951-02-02 1951-02-03   2 days</span></span>
<span><span class="co">#&gt; 4 mucho_calor 1951-02-06 1951-02-12   7 days</span></span>
<span><span class="co">#&gt; 5 mucho_calor 1951-02-17 1951-02-23   7 days</span></span>
<span><span class="co">#&gt; 6 mucho_calor 1951-03-01 1951-03-03   3 days</span></span></code></pre></div>
<p>Nuevamente, se podría visualizar el cambio en la longitud promedio de
las olas de calor y de olas de heladas de esta forma:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">olas_de_temperatura</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ola</span>, anio <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">inicio</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>longitud <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">longitud</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">anio</span>, <span class="va">longitud</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"glm"</span>, method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"quasipoisson"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">ola</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="estadisticas-e-indices-climaticos_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="mapas">Mapas<a class="anchor" aria-label="anchor" href="#mapas"></a>
</h2>
<p>Si se tienen observaciones en estaciones, la función
<code><a href="../reference/mapear.html">mapear()</a></code> genera un mapa de contornos llenos con el mapa de
Argentina, países limítrofes y logo del INTA.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">496</span><span class="op">)</span></span>
<span><span class="va">datos_aleatorios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="../reference/metadatos_nh.html">metadatos_nh</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">datos_aleatorios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">datos_aleatorios</span>, pp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">datos_aleatorios</span><span class="op">)</span>, <span class="fl">0.5</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">70</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">datos_aleatorios</span>, <span class="fu"><a href="../reference/mapear.html">mapear</a></span><span class="op">(</span><span class="va">pp</span>, <span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="estadisticas-e-indices-climaticos_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
<p>Con el argumento <code>escala</code> se puede definir la escala de
colores y, opcionalmente, los niveles en los niveles a graficar. Esto
permite tener mapas consistentes. El paquete viene con una serie de
escalas ya definidas (ver ?escalas) y la función
<code><a href="../reference/leer_surfer.html">leer_surfer()</a></code> que permite generar estas escalas a partir de
los archivos .lvl que usa el programa Surfer.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">datos_aleatorios</span>, <span class="fu"><a href="../reference/mapear.html">mapear</a></span><span class="op">(</span><span class="va">pp</span>, <span class="va">lon</span>, <span class="va">lat</span>, escala <span class="op">=</span> <span class="va">escala_pp_diaria</span>, cordillera <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="estadisticas-e-indices-climaticos_files/figure-html/unnamed-chunk-25-1.png" width="672"></p>
<p>El argumento <code>cordillera</code> controla si se va a pintar de
gris las regiones de altura, donde el kriging que se usa para interpolar
los datos entre los puntos observados posiblemente sea aún menos válido
que en el resto del territorio.</p>
<p>Finalmente, los argumentos <code>titulo</code>,
<code>subtitulo</code> y <code>fuente</code> permiten agregar
información extra.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">datos_aleatorios</span>, <span class="fu"><a href="../reference/mapear.html">mapear</a></span><span class="op">(</span><span class="va">pp</span>, <span class="va">lon</span>, <span class="va">lat</span>, escala <span class="op">=</span> <span class="va">escala_pp_diaria</span>, cordillera <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              titulo <span class="op">=</span> <span class="st">"Precipitación"</span>, </span>
<span>                              subtitulo <span class="op">=</span> <span class="st">"Para algún día"</span>,</span>
<span>                              fuente <span class="op">=</span> <span class="st">"Fuente: rgamma"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="estadisticas-e-indices-climaticos_files/figure-html/unnamed-chunk-26-1.png" width="672"></p>
<p>Como <code><a href="../reference/mapear.html">mapear()</a></code> devuelve un objeto de ggplot2, se puede
seguir customizando con cualquier función de ese paquete.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>En esta página</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Desarrollado por Elio Campitelli, Paola Corrales, Natalia Gattinoni.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Sitio creado con <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
